

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Refining the disease model &mdash; MetaWards Documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/custom.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Adjustable Variables" href="02_adjustable.html" />
    <link rel="prev" title="Part 2 - Refining the model" href="../index_part02.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/logo.jpg" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
  <div id="version_box"></div>
</div>


          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../features.html">Features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation instructions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../model_data.html">Model data</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index_part01.html">Part 1 - Modelling outbreaks</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index_part02.html">Part 2 - Refining the model</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Refining the disease model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#understanding-the-disease-file">Understanding the disease file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modifying-the-disease-file">Modifying the disease file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="02_adjustable.html">Adjustable Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="03_analysis.html">Analysing the output</a></li>
<li class="toctree-l3"><a class="reference internal" href="04_cluster.html">Running on a cluster</a></li>
<li class="toctree-l3"><a class="reference internal" href="05_refining.html">Refining the model</a></li>
<li class="toctree-l3"><a class="reference internal" href="06_model_data.html">Model data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index_part03.html">Part 3 - Customising the outbreak</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index_part04.html">Part 4 - Customising the output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index_part05.html">Part 5 - Modelling multiple demographics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index_part06.html">Part 6 - Moving between demographics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index_part07.html">Part 7 - Different pathways for different demographics</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cluster_usage.html">Running on a cluster</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../support.html">Help and support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devsupport.html">Developer Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../packaging.html">Packaging releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development.html">Developer’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../snaglist.html">Snag list</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgements.html">Acknowledgements</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MetaWards</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Tutorial</a> &raquo;</li>
        
          <li><a href="../index_part02.html">Part 2 - Refining the model</a> &raquo;</li>
        
      <li>Refining the disease model</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="02_adjustable.html" class="btn btn-neutral float-right" title="Adjustable Variables" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index_part02.html" class="btn btn-neutral float-left" title="Part 2 - Refining the model" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="refining-the-disease-model">
<h1>Refining the disease model<a class="headerlink" href="#refining-the-disease-model" title="Permalink to this headline">¶</a></h1>
<p>In the last part of the tutorial you plotted graphs that showed the progress
of the lurgy across four <em>model runs</em> of the outbreak which were seeded
in London.</p>
<p>While this was good, the <em>model runs</em> were performed using an initial,
possibly poor model of the lurgy. Our next step is to customise the
<code class="docutils literal notranslate"><span class="pre">disease</span> <span class="pre">file</span></code> to build a more representative model.</p>
<div class="section" id="understanding-the-disease-file">
<h2>Understanding the disease file<a class="headerlink" href="#understanding-the-disease-file" title="Permalink to this headline">¶</a></h2>
<p>The model of the lurgy is based on the
<a class="reference external" href="https://github.com/metawards/MetaWardsData/blob/master/diseases/lurgy.json">disease file</a>
contained in the
<a class="reference external" href="https://github.com/metawards/MetaWardsData">MetaWardsData</a> repository.</p>
<p>The first step to customise this file is to copy it into our current
directory and rename it to <code class="docutils literal notranslate"><span class="pre">lurgy2.json</span></code>.
Assuming you have set the <code class="docutils literal notranslate"><span class="pre">METAWARDSDATA</span></code> environment
variable equal to the path to this directory, type;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp <span class="nv">$METAWARDSDATA</span>/diseases/lurgy.json ./lurgy2.json
</pre></div>
</div>
<p>on Linux or Mac OS X, or type;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>copy <span class="nv">$Env</span>:METAWARDSDATA<span class="se">\d</span>iseases<span class="se">\l</span>urgy.json lurgy2.json
</pre></div>
</div>
<p>on Windows.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The above command work on Linux, Mac (OS X) or Windows. If you are following
this tutorial using a different operating system and know the correct
copy command to use, then please send it to us by sending us a
<a class="reference external" href="https://github.com/metawards/MetaWards">pull request</a>
or <a class="reference external" href="https://github.com/metawards/MetaWards/issues">posting an issue</a>.</p>
</div>
<p>The disease file for the lurgy looks like the following;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&quot;name&quot;</span>             <span class="p">:</span> <span class="s2">&quot;The Lurgy&quot;</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span>          <span class="p">:</span> <span class="s2">&quot;April 16th 2020&quot;</span><span class="p">,</span>
  <span class="s2">&quot;author(s)&quot;</span>        <span class="p">:</span> <span class="s2">&quot;Christopher Woods&quot;</span><span class="p">,</span>
  <span class="s2">&quot;contact(s)&quot;</span>       <span class="p">:</span> <span class="s2">&quot;christopher.woods@bristol.ac.uk&quot;</span><span class="p">,</span>
  <span class="s2">&quot;reference(s)&quot;</span>     <span class="p">:</span> <span class="s2">&quot;Completely ficticious disease - no references&quot;</span><span class="p">,</span>
  <span class="s2">&quot;beta&quot;</span>             <span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
  <span class="s2">&quot;progress&quot;</span>         <span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
  <span class="s2">&quot;too_ill_to_move&quot;</span>  <span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
  <span class="s2">&quot;contrib_foi&quot;</span>      <span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The file is in <a class="reference external" href="https://en.wikipedia.org/wiki/JSON">JSON</a> format. This
is easy for computers to read, and relatively easy for us to read too ;-)</p>
<p>Notice that the file contains metadata, e.g. <strong>version</strong>, <strong>author(s)</strong>,
<strong>references</strong> that embed some extra context into where the data for
this file comes from. Feel free to edit the file and add your metadata.</p>
<p>The key parameters for the disease are the set of numbers associated
with <strong>beta</strong>, <strong>progress</strong>, <strong>too_ill_to_move</strong> and <strong>contrib_foi</strong>.</p>
<p>These lists provide the values for those parameters in the model for the
different stages of the disease. In this case, the lurgy has five
stages (also called classes). An individual who is infected progresses
along each stage (or class) in turn according to the value of the parameters;</p>
<ul class="simple">
<li><strong>beta</strong> - the rate of infection of the disease. For the first two stages
the value of <strong>beta</strong> is zero, meaning that infected individuals are
not infectious. However, individuals are infectious in stages three
and four, when <strong>beta</strong> is 0.5. The final fifth stage is when the individual
is removed from the outbreak, when the <strong>beta</strong> value is zero again.</li>
<li><strong>progess</strong> - rate of progression of an individual through the stages
of the disease. Individuals progress quickly through the first two
stages (where <strong>progress</strong> is 1.0), and then progress slows down
in the third and fourth stages (<strong>progress</strong> is 0.5). The fifth stage
is the final stage, and so the <strong>progress</strong> value is zero.</li>
<li><strong>too_ill_to_move</strong> - the proportion of infected individuals who are
unable to move. This starts low in the initial stages, e.g. at
stage three individuals can move (<strong>too_ill_to_move</strong> is 0.5) and
are quite infectious (<strong>beta</strong> is 0.5). This progresses up to 1.0
for the final stage, when the individual is removed from the oubreak.</li>
<li><strong>contrib_foi</strong> - this is how much the infected individuals contribute
to the force of infection in their home electoral ward or during
their work commute. In this case, individuals infected with
this model lurgy contribute fully (<strong>contrib_foi</strong> is 1.0) for all
but the final stage, when they are removed from the outbreak.</li>
</ul>
</div>
<div class="section" id="modifying-the-disease-file">
<h2>Modifying the disease file<a class="headerlink" href="#modifying-the-disease-file" title="Permalink to this headline">¶</a></h2>
<p>With the current model, the lurgy only becomes infectious when
the infected individual are already showing symptoms and have
reduced mobility. For the lurgy that we want to model we need to
represent the lurgy as a disease that is infectious for a period
of time before the individual is showing symptoms. To this end,
we will an extra stage in the middle for which <strong>beta</strong> is high
but <strong>too_ill_to_move</strong> is still zero. Edit your copy of
<code class="docutils literal notranslate"><span class="pre">lurgy2.json</span></code> to read;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&quot;name&quot;</span>             <span class="p">:</span> <span class="s2">&quot;The Lurgy&quot;</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span>          <span class="p">:</span> <span class="s2">&quot;April 16th 2020&quot;</span><span class="p">,</span>
  <span class="s2">&quot;author(s)&quot;</span>        <span class="p">:</span> <span class="s2">&quot;Christopher Woods&quot;</span><span class="p">,</span>
  <span class="s2">&quot;contact(s)&quot;</span>       <span class="p">:</span> <span class="s2">&quot;christopher.woods@bristol.ac.uk&quot;</span><span class="p">,</span>
  <span class="s2">&quot;reference(s)&quot;</span>     <span class="p">:</span> <span class="s2">&quot;Completely ficticious disease - no references&quot;</span><span class="p">,</span>
  <span class="s2">&quot;beta&quot;</span>             <span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
  <span class="s2">&quot;progress&quot;</span>         <span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
  <span class="s2">&quot;too_ill_to_move&quot;</span>  <span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
  <span class="s2">&quot;contrib_foi&quot;</span>      <span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Once you have saved the file you can perform a single <em>model run</em>
using this file via;</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>metawards -d lurgy2 -a ExtraSeedsLondon.dat
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">metawards</span></code> automatically used your <code class="docutils literal notranslate"><span class="pre">lurgy2.json</span></code> file as it
found the file in your current directory. You can pass a full path to
your file, with or without the <code class="docutils literal notranslate"><span class="pre">.json</span></code> extension</p>
</div>
<p>This will run the <code class="docutils literal notranslate"><span class="pre">metawards</span></code> <em>model run</em> for your new version of the
lurgy. Notice that near the top of the output you have your parameters
and the metadata printed to the screen, e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Disease ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

• Disease: lurgy2
• loaded from: lurgy2.json
• repository: /Users/chris/GitHub/MetaWardsData
• repository_branch: None
• repository_version: None
• beta: [0.0, 0.0, 0.5, 0.5, 0.5, 0.0]
• progress: [1.0, 1.0, 1.0, 0.5, 0.5, 0.0]
• too_ill_to_move: [0.0, 0.0, 0.0, 0.5, 0.8, 1.0]
• contrib_foi: [1.0, 1.0, 1.0, 1.0, 1.0, 0.0]
• start_symptom: 3
</pre></div>
</div>
<p>Again, this helps someone reproduce this output in the future.</p>
<p>This model run may take longer, as, intuitively, you would expect that
the changes we have made mean that more individuals are likely to be
infected. Indeed, for the run I performed, copied below,
the outbreak lasted for 196 days, involving nearly 50m individuals.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Day 189 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
S: 6225870  E: 1  I: 3  R: 49856203  IW: 0  POPULATION: 56082077
Number of infections: 4

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Day 190 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
S: 6225870  E: 0  I: 2  R: 49856205  IW: 0  POPULATION: 56082077
Number of infections: 2

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Day 191 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
S: 6225870  E: 0  I: 2  R: 49856205  IW: 0  POPULATION: 56082077
Number of infections: 2

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Day 192 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
S: 6225870  E: 0  I: 2  R: 49856205  IW: 0  POPULATION: 56082077
Number of infections: 2

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Day 193 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
S: 6225870  E: 0  I: 2  R: 49856205  IW: 0  POPULATION: 56082077
Number of infections: 2

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Day 194 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
S: 6225870  E: 0  I: 2  R: 49856205  IW: 0  POPULATION: 56082077
Number of infections: 2

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Day 195 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
S: 6225870  E: 0  I: 1  R: 49856206  IW: 0  POPULATION: 56082077
Number of infections: 1

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Day 196 ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
S: 6225870  E: 0  I: 0  R: 49856207  IW: 0  POPULATION: 56082077
Number of infections: 0
Infection died ... Ending on day 197
</pre></div>
</div>
<p>An overview plot of the outbreak, created using</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>metawards-plot -i output/results.csv.bz2
</pre></div>
</div>
<p>shows the much higher peak of the outbreak compared to our original
model of the lurgy.</p>
<img alt="Overview image of the outbreak of second version of the lurgy" src="../../_images/tutorial_2_1_overview.jpg" />
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="02_adjustable.html" class="btn btn-neutral float-right" title="Adjustable Variables" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index_part02.html" class="btn btn-neutral float-left" title="Part 2 - Refining the model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
      <span class="lastupdated">
        Last updated on Jun 23, 2020.
      </span>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>